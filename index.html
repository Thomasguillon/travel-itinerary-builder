<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Itinerary Builder - Paris, France</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background: url('https://images.unsplash.com/photo-1503919238455-390705d369bb?q=80&w=2070&auto=format&fit=crop') no-repeat center center fixed;
      background-size: cover;
      line-height: 1.6;
      color: #333;
      position: relative;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.4);
      z-index: -1;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 0 15px;
    }
    h1 {
      text-align: center;
      color: #fff;
      margin-bottom: 20px;
    }
    h2 {
      text-align: center;
      color: #ffd700; /* Gold for main title */
      margin-bottom: 20px;
    }
    h3 {
      text-align: center;
      margin-bottom: 10px;
    }
    h3.day {
      color: #ff4500; /* OrangeRed for Day 1 */
    }
    h3.local-tips {
      color: #ff6347; /* Tomato red for Local Tips */
    }
    h3.premium-extras {
      color: #4682b4; /* Steel blue for Premium Extras */
    }
    h3.recommendations {
      color: #32cd32; /* Lime green for Recommendations */
    }
    p.subtitle {
      text-align: center;
      color: #f0f0f0;
      margin-bottom: 20px;
    }
    form {
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }
    .form-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    label {
      width: 150px;
      font-weight: bold;
      color: #333;
    }
    select, input, button {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
      flex: 1;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0056b3;
    }
    #output {
      margin-top: 20px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    .error {
      color: #d9534f;
      font-weight: bold;
    }
    .budget-warning {
      background-color: #fff3cd;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .budget-warning button {
      margin-top: 10px;
      background-color: #28a745;
      padding: 5px 10px;
      font-size: 14px;
    }
    .budget-warning button:hover {
      background-color: #218838;
    }
    .upgrade {
      margin-top: 15px;
      font-style: italic;
      text-align: center;
    }
    .recommendations {
      margin-top: 20px;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 8px;
    }
    .local-tip {
      margin-top: 20px;
      padding: 15px;
      background-color: #e6f3ff;
      border-radius: 8px;
    }
    .hidden {
      display: none;
    }
    a {
      color: #007bff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    @media (max-width: 600px) {
      .container {
        padding: 0 10px;
      }
      h1 {
        font-size: 24px;
      }
      h2, h3 {
        font-size: 20px;
      }
      form, #output {
        padding: 15px;
      }
      .form-row {
        flex-direction: column;
        align-items: flex-start;
      }
      label {
        width: auto;
      }
      select, input, button {
        font-size: 14px;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Travel Itinerary Builder - Paris, France</h1>
    <p class="subtitle">Choose your preferences to get a 1-day free itinerary for Paris, France. Upgrade to premium for more options!</p>
    <form id="travelForm">
      <div class="form-row">
        <label for="countrySelect">Country:</label>
        <select name="country" id="countrySelect" required>
          <option value="France" selected>France</option>
        </select>
      </div>
      <div class="form-row">
        <label for="citySelect">City:</label>
        <select name="city" id="citySelect" required>
          <option value="Paris" selected>Paris</option>
        </select>
      </div>
      <div class="form-row">
        <label for="interests">Interests:</label>
        <select name="interests">
          <option value="" selected>Any Interest</option>
          <option value="art">Art</option>
          <option value="history">History</option>
          <option value="nature">Nature</option>
          <option value="adventure">Adventure</option>
          <option value="shopping">Shopping</option>
          <option value="for-kids">For Kids</option>
        </select>
      </div>
      <div class="form-row">
        <label for="food">Food:</label>
        <select name="food">
          <option value="" selected>Any Food</option>
          <option value="French">French</option>
          <option value="Vegan">Vegan</option>
          <option value="Italian">Italian</option>
          <option value="Asian">Asian</option>
          <option value="Fast Food">Fast Food</option>
          <option value="Local Street Food">Local Street Food</option>
        </select>
      </div>
      <div class="form-row">
        <label for="budget">Budget (per person):</label>
        <select name="budget" required>
          <option value="" disabled selected>Select Budget Range</option>
          <option value="low">Low ($0-50)</option>
          <option value="medium">Medium ($51-150)</option>
          <option value="high">High ($151+)</option>
        </select>
      </div>
      <div class="form-row">
        <label for="currency">Currency:</label>
        <select name="currency">
          <option value="" selected>USD (Default)</option>
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
        </select>
      </div>
      <div class="form-row">
        <label for="persons">Number of Persons:</label>
        <select name="persons" required>
          <option value="" disabled selected>Select Number of Persons</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4+">4 or more</option>
        </select>
      </div>
      <div class="form-row">
        <label for="timeOfDay">Time of Day:</label>
        <select name="timeOfDay">
          <option value="" selected>Any Time</option>
          <option value="morning">Morning</option>
          <option value="lunch">Lunch</option>
          <option value="afternoon">Afternoon</option>
          <option value="evening">Evening</option>
        </select>
      </div>
      <div class="form-row">
        <label for="code">Premium Code:</label>
        <input type="text" name="code" placeholder="Premium Code (optional)">
      </div>
      <div class="form-row">
        <label for="previewPremium">Preview Premium:</label>
        <label><input type="checkbox" name="previewPremium" value="true"> Preview Premium Features (For Testing)</label>
      </div>
      <button type="submit">Generate Itinerary</button>
    </form>
    <div id="output"></div>
  </div>

  <script>
    const travelData = {
      "France": {
        "cities": {
          "Paris": {
            "restaurants": {
              "French": [
                { "budget": "low", "name": "Chez Gladines", "cost": 15, "url": "https://www.chezgladines.fr/", "time": "afternoon", "interest": "history", "nearestMetro": "Place Monge (Line 7)", "nearestBus": "Bus 47 - Monge" },
                { "budget": "medium", "name": "Brasserie Lipp", "cost": 50, "url": "https://www.brasserielipp.fr/en/", "time": "evening", "interest": "history", "nearestMetro": "Saint-Germain-des-Prés (Line 4)", "nearestBus": "Bus 39 - Saint-Germain-des-Prés" },
                { "budget": "high", "name": "Le Jules Verne", "cost": 150, "url": "https://www.restaurants-toureiffel.com/en/le-jules-verne.html", "time": "evening", "interest": "adventure", "nearestMetro": "Bir-Hakeim (Line 6)", "nearestBus": "Bus 69 - Champ de Mars" }
              ],
              "Vegan": [
                { "budget": "low", "name": "Le Grenier de Notre-Dame", "cost": 20, "url": "https://www.legrenierdenotredame.fr/", "time": "afternoon", "interest": "nature", "nearestMetro": "Maubert-Mutualité (Line 10)", "nearestBus": "Bus 47 - Maubert-Mutualité" },
                { "budget": "medium", "name": "Le Potager de Charlotte", "cost": 30, "url": "https://www.lepotagerdecharlotte.fr/en/", "time": "evening", "interest": "nature", "nearestMetro": "Poissonnière (Line 7)", "nearestBus": "Bus 39 - Poissonnière" },
                { "budget": "high", "name": "Gentle Gourmet", "cost": 60, "url": "https://www.gentlegourmet.fr/", "time": "evening", "interest": "nature", "nearestMetro": "Bastille (Lines 1, 5, 8)", "nearestBus": "Bus 87 - Bastille" }
              ],
              "Italian": [
                { "budget": "low", "name": "Pizza Julia", "cost": 15, "url": "https://www.pizzajulia.fr/", "time": "afternoon", "interest": "shopping", "nearestMetro": "Bastille (Lines 1, 5, 8)", "nearestBus": "Bus 87 - Bastille" },
                { "budget": "medium", "name": "Pizzeria Popolare", "cost": 25, "url": "https://www.bigmammagroup.com/en/trattorias/pizzeria-popolare", "time": "evening", "interest": "shopping", "nearestMetro": "Réaumur-Sébastopol (Lines 3, 4)", "nearestBus": "Bus 38 - Réaumur-Sébastopol" },
                { "budget": "high", "name": "Il Vicolo", "cost": 55, "url": "https://www.ilvicolo-paris.fr/", "time": "evening", "interest": "shopping", "nearestMetro": "Saint-Paul (Line 1)", "nearestBus": "Bus 96 - Saint-Paul" }
              ],
              "Asian": [
                { "budget": "low", "name": "Kodawari Ramen", "cost": 20, "url": "https://www.kodawari-ramen.com/", "time": "afternoon", "interest": "adventure", "nearestMetro": "Odéon (Lines 4, 10)", "nearestBus": "Bus 58 - Odéon" },
                { "budget": "medium", "name": "Miss Kô", "cost": 40, "url": "https://www.miss-ko.com/", "time": "evening", "interest": "adventure", "nearestMetro": "George V (Line 1)", "nearestBus": "Bus 73 - George V" },
                { "budget": "high", "name": "Shang Palace", "cost": 80, "url": "https://www.shangri-la.com/paris/shangrila/dining/restaurants/shang-palace/", "time": "evening", "interest": "adventure", "nearestMetro": "Iéna (Line 9)", "nearestBus": "Bus 32 - Iéna" }
              ],
              "Fast Food": [
                { "budget": "low", "name": "McDonald’s", "cost": 10, "url": "https://www.mcdonalds.fr/", "time": "afternoon", "interest": "for-kids", "nearestMetro": "George V (Line 1)", "nearestBus": "Bus 73 - George V" },
                { "budget": "medium", "name": "Five Guys", "cost": 15, "url": "https://www.fiveguys.fr/", "time": "evening", "interest": "for-kids", "nearestMetro": "Bercy (Lines 6, 14)", "nearestBus": "Bus 24 - Bercy" },
                { "budget": "high", "name": "Shake Shack", "cost": 20, "url": "https://www.shakeshack.com/", "time": "evening", "interest": "for-kids", "nearestMetro": "Châtelet (Lines 1, 4, 7, 11, 14)", "nearestBus": "Bus 38 - Châtelet" }
              ],
              "Local Street Food": [
                { "budget": "low", "name": "Chez Alain Miam Miam", "cost": 10, "url": "https://www.paris.fr/pages/chez-alain-miam-miam-2415", "time": "afternoon", "interest": "art", "nearestMetro": "Saint-Germain-des-Prés (Line 4)", "nearestBus": "Bus 39 - Saint-Germain-des-Prés" },
                { "budget": "medium", "name": "Marché des Enfants Rouges", "cost": 12, "url": "https://www.paris.fr/lieux/marche-des-enfants-rouges-1799", "time": "morning", "interest": "art", "nearestMetro": "Temple (Line 3)", "nearestBus": "Bus 75 - Temple" },
                { "budget": "high", "name": "Le Food Market", "cost": 20, "url": "https://www.lefoodmarket.fr/", "time": "evening", "interest": "art", "nearestMetro": "Belleville (Lines 2, 11)", "nearestBus": "Bus 20 - Belleville" }
              ]
            },
            "activities": {
              "art": [
                { "name": "Louvre Museum", "cost": 20, "url": "https://www.louvre.fr/en", "time": "morning", "nearestMetro": "Palais Royal - Musée du Louvre (Lines 1, 7)", "nearestBus": "Bus 21 - Palais Royal" },
                { "name": "Musée d’Orsay", "cost": 14, "url": "https://www.musee-orsay.fr/en", "time": "afternoon", "nearestMetro": "Solférino (Line 12)", "nearestBus": "Bus 68 - Solférino" },
                { "name": "Centre Pompidou", "cost": 15, "url": "https://www.centrepompidou.fr/en/", "time": "afternoon", "nearestMetro": "Rambuteau (Line 11)", "nearestBus": "Bus 38 - Centre Georges Pompidou" },
                { "name": "Musée Rodin", "cost": 12, "url": "https://www.musee-rodin.fr/en", "time": "morning", "nearestMetro": "Varenne (Line 13)", "nearestBus": "Bus 69 - Varenne" },
                { "name": "Musée de l’Orangerie", "cost": 12.5, "url": "https://www.musee-orangerie.fr/en", "time": "afternoon", "nearestMetro": "Concorde (Lines 1, 8, 12)", "nearestBus": "Bus 72 - Concorde" }
              ],
              "history": [
                { "name": "Notre-Dame Cathedral", "cost": 0, "url": "https://www.notredamedeparis.fr/en/", "time": "morning", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 47 - Cité" },
                { "name": "Palace of Versailles", "cost": 19.5, "url": "https://en.chateauversailles.fr/", "time": "afternoon", "nearestMetro": "Versailles Château Rive Gauche (RER C)", "nearestBus": "Bus 171 - Versailles" },
                { "name": "Sainte-Chapelle", "cost": 11.5, "url": "https://www.sainte-chapelle.fr/en/", "time": "morning", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 21 - Cité" },
                { "name": "The Conciergerie", "cost": 9, "url": "https://www.paris-conciergerie.fr/en/", "time": "afternoon", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 21 - Cité" },
                { "name": "Les Invalides", "cost": 14, "url": "https://www.musee-armee.fr/en/", "time": "afternoon", "nearestMetro": "La Tour-Maubourg (Line 8)", "nearestBus": "Bus 28 - Invalides" }
              ],
              "nature": [
                { "name": "Jardin des Tuileries", "cost": 0, "url": "https://www.paris.fr/lieux/jardin-des-tuileries-1795", "time": "morning", "nearestMetro": "Tuileries (Line 1)", "nearestBus": "Bus 72 - Tuileries" },
                { "name": "Bois de Boulogne", "cost": 0, "url": "https://www.paris.fr/lieux/bois-de-boulogne-2468", "time": "afternoon", "nearestMetro": "Porte Dauphine (Line 2)", "nearestBus": "Bus 244 - Porte Dauphine" },
                { "name": "Luxembourg Gardens", "cost": 0, "url": "https://www.paris.fr/lieux/jardin-du-luxembourg-1807", "time": "morning", "nearestMetro": "Luxembourg (RER B)", "nearestBus": "Bus 89 - Luxembourg" },
                { "name": "Parc des Buttes-Chaumont", "cost": 0, "url": "https://www.paris.fr/lieux/parc-des-buttes-chaumont-1802", "time": "afternoon", "nearestMetro": "Buttes Chaumont (Line 7bis)", "nearestBus": "Bus 26 - Buttes Chaumont" },
                { "name": "Jardin des Plantes", "cost": 0, "url": "https://www.jardindesplantesdeparis.fr/en", "time": "morning", "nearestMetro": "Jussieu (Lines 7, 10)", "nearestBus": "Bus 67 - Jussieu" }
              ],
              "adventure": [
                { "name": "Seine River Cruise", "cost": 15, "url": "https://www.bateauxparisiens.com/en/", "time": "evening", "nearestMetro": "Bir-Hakeim (Line 6)", "nearestBus": "Bus 72 - Pont de Bir-Hakeim" },
                { "name": "Eiffel Tower Summit", "cost": 26, "url": "https://www.toureiffel.paris/en", "time": "afternoon", "nearestMetro": "Bir-Hakeim (Line 6)", "nearestBus": "Bus 69 - Champ de Mars" },
                { "name": "Paris Catacombs Tour", "cost": 29, "url": "https://www.catacombes.paris.fr/en/", "time": "morning", "nearestMetro": "Denfert-Rochereau (Lines 4, 6)", "nearestBus": "Bus 38 - Denfert-Rochereau" },
                { "name": "Bike Tour of Paris", "cost": 35, "url": "https://www.fattiretours.com/paris", "time": "afternoon", "nearestMetro": "Trocadéro (Lines 6, 9)", "nearestBus": "Bus 32 - Trocadéro" },
                { "name": "Hot Air Balloon Ride", "cost": 250, "url": "https://www.ballondeparis.com/en/", "time": "morning", "nearestMetro": "Balard (Line 8)", "nearestBus": "Bus 39 - Balard" }
              ],
              "shopping": [
                { "name": "Galeries Lafayette", "cost": 0, "url": "https://www.galerieslafayette.com/en/", "time": "afternoon", "nearestMetro": "Chaussée d'Antin - La Fayette (Lines 7, 9)", "nearestBus": "Bus 32 - Chaussée d'Antin" },
                { "name": "Champs-Élysées", "cost": 0, "url": "https://www.paris.fr/lieux/avenue-des-champs-elysees-1793", "time": "evening", "nearestMetro": "George V (Line 1)", "nearestBus": "Bus 73 - George V" },
                { "name": "Le Marais Boutiques", "cost": 0, "url": "https://www.paris.fr/lieux/le-marais-1801", "time": "afternoon", "nearestMetro": "Saint-Paul (Line 1)", "nearestBus": "Bus 96 - Saint-Paul" },
                { "name": "Marché aux Puces", "cost": 0, "url": "https://marcheauxpuces-saintouen.com/en/", "time": "morning", "nearestMetro": "Porte de Clignancourt (Line 4)", "nearestBus": "Bus 85 - Porte de Clignancourt" },
                { "name": "Passage des Panoramas", "cost": 0, "url": "https://www.paris.fr/lieux/passage-des-panoramas-1803", "time": "afternoon", "nearestMetro": "Grands Boulevards (Lines 8, 9)", "nearestBus": "Bus 20 - Grands Boulevards" }
              ],
              "for-kids": [
                { "name": "Disneyland Paris", "cost": 60, "url": "https://www.disneylandparis.com/en-us/", "time": "afternoon", "nearestMetro": "Marne-la-Vallée/Chessy (RER A)", "nearestBus": "Bus 50 - Disneyland Paris" },
                { "name": "Parc de la Villette - Cité des Enfants", "cost": 12, "url": "https://www.cite-sciences.fr/en/children", "time": "morning", "nearestMetro": "Porte de la Villette (Line 7)", "nearestBus": "Bus 139 - Porte de la Villette" },
                { "name": "Jardin d’Acclimatation", "cost": 5, "url": "https://www.jardindacclimatation.fr/en", "time": "afternoon", "nearestMetro": "Les Sablons (Line 1)", "nearestBus": "Bus 43 - Les Sablons" },
                { "name": "Paris Zoo (Parc Zoologique)", "cost": 20, "url": "https://www.parczoologiquedeparis.fr/en", "time": "morning", "nearestMetro": "Porte Dorée (Line 8)", "nearestBus": "Bus 46 - Porte Dorée" },
                { "name": "Aquarium de Paris", "cost": 25, "url": "https://www.aquariumdeparis.com/en", "time": "afternoon", "nearestMetro": "Trocadéro (Lines 6, 9)", "nearestBus": "Bus 72 - Trocadéro" }
              ]
            },
            "recommendations": {
              "low": {
                "activities": [
                  { "name": "Walk along the Seine", "cost": 0, "url": "https://www.paris.fr/lieux/quais-de-seine-1798", "interest": "art", "time": "morning", "nearestMetro": "Pont Neuf (Line 7)", "nearestBus": "Bus 58 - Pont Neuf" },
                  { "name": "Picnic at Luxembourg Gardens", "cost": 5, "url": "https://www.paris.fr/lieux/jardin-du-luxembourg-1807", "interest": "nature", "time": "afternoon", "nearestMetro": "Luxembourg (RER B)", "nearestBus": "Bus 89 - Luxembourg" },
                  { "name": "Visit Montmartre", "cost": 0, "url": "https://www.paris.fr/lieux/montmartre-1800", "interest": "history", "time": "evening", "nearestMetro": "Anvers (Line 2)", "nearestBus": "Bus 54 - Anvers" },
                  { "name": "Jardin d’Acclimatation", "cost": 5, "url": "https://www.jardindacclimatation.fr/en", "interest": "for-kids", "time": "afternoon", "nearestMetro": "Les Sablons (Line 1)", "nearestBus": "Bus 43 - Les Sablons" },
                  { "name": "Explore Île de la Cité", "cost": 0, "url": "https://www.paris.fr/lieux/ile-de-la-cite-1805", "interest": "history", "time": "lunch", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 47 - Cité" },
                  { "name": "Stroll through Le Marais", "cost": 0, "url": "https://www.paris.fr/lieux/le-marais-1801", "interest": "shopping", "time": "afternoon", "nearestMetro": "Saint-Paul (Line 1)", "nearestBus": "Bus 96 - Saint-Paul" }
                ],
                "restaurants": [
                  { "name": "Chez Gladines", "cost": 15, "url": "https://www.chezgladines.fr/", "type": "French", "interest": "history", "time": "afternoon", "nearestMetro": "Place Monge (Line 7)", "nearestBus": "Bus 47 - Monge" },
                  { "name": "Chez Alain Miam Miam", "cost": 10, "url": "https://www.paris.fr/pages/chez-alain-miam-miam-2415", "type": "Local Street Food", "interest": "art", "time": "afternoon", "nearestMetro": "Saint-Germain-des-Prés (Line 4)", "nearestBus": "Bus 39 - Saint-Germain-des-Prés" },
                  { "name": "McDonald’s", "cost": 10, "url": "https://www.mcdonalds.fr/", "type": "Fast Food", "interest": "for-kids", "time": "afternoon", "nearestMetro": "George V (Line 1)", "nearestBus": "Bus 73 - George V" },
                  { "name": "Angelina", "cost": 10, "url": "https://www.angelina-paris.fr/en", "type": "Dessert", "interest": "art", "time": "afternoon", "nearestMetro": "Tuileries (Line 1)", "nearestBus": "Bus 72 - Tuileries" },
                  { "name": "Café de Flore", "cost": 15, "url": "https://cafedeflore.fr/", "type": "Breakfast", "interest": "history", "time": "morning", "nearestMetro": "Saint-Germain-des-Prés (Line 4)", "nearestBus": "Bus 39 - Saint-Germain-des-Prés" },
                  { "name": "Le Pain Quotidien", "cost": 12, "url": "https://www.lepainquotidien.com/", "type": "Brunch", "interest": "nature", "time": "morning", "nearestMetro": "Saint-Paul (Line 1)", "nearestBus": "Bus 96 - Saint-Paul" }
                ]
              },
              "medium": {
                "activities": [
                  { "name": "Seine River Cruise", "cost": 15, "url": "https://www.bateauxparisiens.com/en/", "interest": "adventure", "time": "evening", "nearestMetro": "Bir-Hakeim (Line 6)", "nearestBus": "Bus 72 - Pont de Bir-Hakeim" },
                  { "name": "Musée Rodin", "cost": 12, "url": "https://www.musee-rodin.fr/en", "interest": "art", "time": "morning", "nearestMetro": "Varenne (Line 13)", "nearestBus": "Bus 69 - Varenne" },
                  { "name": "Sainte-Chapelle", "cost": 11.5, "url": "https://www.sainte-chapelle.fr/en/", "interest": "history", "time": "morning", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 21 - Cité" },
                  { "name": "Parc de la Villette - Cité des Enfants", "cost": 12, "url": "https://www.cite-sciences.fr/en/children", "interest": "for-kids", "time": "morning", "nearestMetro": "Porte de la Villette (Line 7)", "nearestBus": "Bus 139 - Porte de la Villette" },
                  { "name": "Explore Île de la Cité", "cost": 0, "url": "https://www.paris.fr/lieux/ile-de-la-cite-1805", "interest": "history", "time": "lunch", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 47 - Cité" },
                  { "name": "Stroll through Le Marais", "cost": 0, "url": "https://www.paris.fr/lieux/le-marais-1801", "interest": "shopping", "time": "afternoon", "nearestMetro": "Saint-Paul (Line 1)", "nearestBus": "Bus 96 - Saint-Paul" }
                ],
                "restaurants": [
                  { "name": "Le Potager de Charlotte", "cost": 30, "url": "https://www.lepotagerdecharlotte.fr/en/", "type": "Vegan", "interest": "nature", "time": "evening", "nearestMetro": "Poissonnière (Line 7)", "nearestBus": "Bus 39 - Poissonnière" },
                  { "name": "Pizzeria Popolare", "cost": 25, "url": "https://www.bigmammagroup.com/en/trattorias/pizzeria-popolare", "type": "Italian", "interest": "shopping", "time": "evening", "nearestMetro": "Réaumur-Sébastopol (Lines 3, 4)", "nearestBus": "Bus 38 - Réaumur-Sébastopol" },
                  { "name": "Miss Kô", "cost": 40, "url": "https://www.miss-ko.com/", "type": "Asian", "interest": "adventure", "time": "evening", "nearestMetro": "George V (Line 1)", "nearestBus": "Bus 73 - George V" },
                  { "name": "Ladurée", "cost": 20, "url": "https://www.laduree.fr/", "type": "Dessert", "interest": "shopping", "time": "afternoon", "nearestMetro": "Champs-Élysées - Clemenceau (Lines 1, 13)", "nearestBus": "Bus 73 - Champs-Élysées" },
                  { "name": "Les Deux Magots", "cost": 25, "url": "https://lesdeuxmagots.fr/en/", "type": "Breakfast", "interest": "art", "time": "morning", "nearestMetro": "Saint-Germain-des-Prés (Line 4)", "nearestBus": "Bus 39 - Saint-Germain-des-Prés" },
                  { "name": "Claus", "cost": 20, "url": "https://clausparis.com/", "type": "Brunch", "interest": "for-kids", "time": "morning", "nearestMetro": "Louvre - Rivoli (Line 1)", "nearestBus": "Bus 21 - Louvre - Rivoli" }
                ]
              },
              "high": {
                "activities": [
                  { "name": "Eiffel Tower Summit", "cost": 26, "url": "https://www.toureiffel.paris/en", "interest": "adventure", "time": "afternoon", "nearestMetro": "Bir-Hakeim (Line 6)", "nearestBus": "Bus 69 - Champ de Mars" },
                  { "name": "Palace of Versailles", "cost": 19.5, "url": "https://en.chateauversailles.fr/", "interest": "history", "time": "afternoon", "nearestMetro": "Versailles Château Rive Gauche (RER C)", "nearestBus": "Bus 171 - Versailles" },
                  { "name": "Lido de Paris Cabaret Show", "cost": 85, "url": "https://www.lido.fr/en/", "interest": "adventure", "time": "evening", "nearestMetro": "George V (Line 1)", "nearestBus": "Bus 73 - George V" },
                  { "name": "Disneyland Paris", "cost": 60, "url": "https://www.disneylandparis.com/en-us/", "interest": "for-kids", "time": "afternoon", "nearestMetro": "Marne-la-Vallée/Chessy (RER A)", "nearestBus": "Bus 50 - Disneyland Paris" },
                  { "name": "Explore Île de la Cité", "cost": 0, "url": "https://www.paris.fr/lieux/ile-de-la-cite-1805", "interest": "history", "time": "lunch", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 47 - Cité" },
                  { "name": "Stroll through Le Marais", "cost": 0, "url": "https://www.paris.fr/lieux/le-marais-1801", "interest": "shopping", "time": "afternoon", "nearestMetro": "Saint-Paul (Line 1)", "nearestBus": "Bus 96 - Saint-Paul" }
                ],
                "restaurants": [
                  { "name": "Le Jules Verne", "cost": 150, "url": "https://www.restaurants-toureiffel.com/en/le-jules-verne.html", "type": "French", "interest": "adventure", "time": "evening", "nearestMetro": "Bir-Hakeim (Line 6)", "nearestBus": "Bus 69 - Champ de Mars" },
                  { "name": "Shang Palace", "cost": 80, "url": "https://www.shangri-la.com/paris/shangrila/dining/restaurants/shang-palace/", "type": "Asian", "interest": "adventure", "time": "evening", "nearestMetro": "Iéna (Line 9)", "nearestBus": "Bus 32 - Iéna" },
                  { "name": "Gentle Gourmet", "cost": 60, "url": "https://www.gentlegourmet.fr/", "type": "Vegan", "interest": "nature", "time": "evening", "nearestMetro": "Bastille (Lines 1, 5, 8)", "nearestBus": "Bus 87 - Bastille" },
                  { "name": "Pierre Hermé", "cost": 25, "url": "https://www.pierreherme.com/", "type": "Dessert", "interest": "art", "time": "afternoon", "nearestMetro": "Saint-Germain-des-Prés (Line 4)", "nearestBus": "Bus 39 - Saint-Germain-des-Prés" },
                  { "name": "Café Constant", "cost": 30, "url": "https://www.maisonconstant.com/cafe-constant", "type": "Breakfast", "interest": "adventure", "time": "morning", "nearestMetro": "École Militaire (Line 8)", "nearestBus": "Bus 82 - École Militaire" },
                  { "name": "Holybelly", "cost": 25, "url": "https://holybellycafe.com/", "type": "Brunch", "interest": "for-kids", "time": "morning", "nearestMetro": "Canal Saint-Martin (Line 5)", "nearestBus": "Bus 46 - Canal Saint-Martin" }
                ]
              }
            },
            "premiumExtras": {
              "secondaryActivities": [
                { "name": "Visit the Latin Quarter", "cost": 0, "url": "https://www.paris.fr/lieux/quartier-latin-1804", "time": "afternoon", "interest": "history", "nearestMetro": "Cluny - La Sorbonne (Line 10)", "nearestBus": "Bus 63 - Cluny" },
                { "name": "Explore Île de la Cité", "cost": 0, "url": "https://www.paris.fr/lieux/ile-de-la-cite-1805", "time": "morning", "interest": "history", "nearestMetro": "Cité (Line 4)", "nearestBus": "Bus 47 - Cité" },
                { "name": "Puppet Show at Luxembourg Gardens", "cost": 6, "url": "https://www.paris.fr/lieux/jardin-du-luxembourg-1807", "time": "afternoon", "interest": "for-kids", "nearestMetro": "Luxembourg (RER B)", "nearestBus": "Bus 89 - Luxembourg" },
                { "name": "Walk along Canal Saint-Martin", "cost": 0, "url": "https://www.paris.fr/lieux/canal-saint-martin", "time": "afternoon", "interest": "nature", "nearestMetro": "République (Lines 3, 5, 8, 9, 11)", "nearestBus": "Bus 75 - République" },
                { "name": "Visit the Latin Quarter", "cost": 0, "url": "https://www.paris.fr/lieux/quartier-latin-1804", "time": "lunch", "interest": "history", "nearestMetro": "Cluny - La Sorbonne (Line 10)", "nearestBus": "Bus 63 - Cluny" }
              ],
              "localTips": {
                "morning": {
                  "art": "Start your day at a nearby café like Les Deux Magots for a classic Parisian breakfast before heading to the Louvre.",
                  "history": "Morning light is perfect for capturing photos of Notre-Dame Cathedral—arrive early to beat the crowds.",
                  "nature": "Take a morning stroll through Jardin des Plantes to enjoy the fresh air and blooming flowers.",
                  "adventure": "Kick off your day with a hot air balloon ride at Parc André Citroën for stunning morning views of Paris.",
                  "shopping": "Visit Marché aux Puces early in the morning to snag the best vintage finds before the crowds arrive.",
                  "for-kids": "Head to Parc de la Villette for a morning of fun at Cité des Enfants—perfect for little explorers."
                },
                "lunch": {
                  "art": "Grab a light lunch at a nearby café like Café de Flore to soak in the artistic vibe of Saint-Germain-des-Prés.",
                  "history": "Enjoy a picnic lunch on Île de la Cité, surrounded by historic landmarks like Notre-Dame.",
                  "nature": "Have a relaxing lunch at a café near Luxembourg Gardens, then stroll through the park.",
                  "adventure": "Refuel with a quick lunch near the Eiffel Tower before heading to a Seine River Cruise.",
                  "shopping": "Take a lunch break at a chic café in Le Marais to recharge for more shopping.",
                  "for-kids": "Grab a family-friendly lunch near Jardin d’Acclimatation to keep the kids energized for more playtime."
                },
                "afternoon": {
                  "art": "Afternoon light is ideal for visiting Musée d’Orsay—don’t miss the Impressionist galleries.",
                  "history": "Spend your afternoon exploring the Palace of Versailles; the gardens are especially beautiful in the afternoon sun.",
                  "nature": "Relax in the afternoon at Parc des Buttes-Chaumont, a perfect spot for a picnic with scenic views.",
                  "adventure": "Climb the Eiffel Tower Summit in the afternoon for breathtaking views of Paris.",
                  "shopping": "Head to Galeries Lafayette in the afternoon for a shopping spree and stunning rooftop views.",
                  "for-kids": "Spend the afternoon at Disneyland Paris for a magical experience the kids will love."
                },
                "evening": {
                  "art": "Evening is the best time to visit Centre Pompidou—stay late for fewer crowds and a sunset view from the rooftop.",
                  "history": "Take an evening stroll through Montmartre to experience its historic charm and vibrant nightlife.",
                  "nature": "Enjoy an evening walk along the Seine River, with the city lights reflecting on the water.",
                  "adventure": "End your day with a Seine River Cruise to see Paris illuminated at night.",
                  "shopping": "Explore the Champs-Élysées in the evening for a magical shopping experience with the avenue lit up.",
                  "for-kids": "Catch a family-friendly show at Lido de Paris in the evening for a memorable night out."
                }
              },
              "culturalInsights": {
                "art": "Parisians value art deeply—expect to see locals sketching or discussing exhibits at museums like the Louvre.",
                "history": "History is alive in Paris; you’ll often find locals sharing stories about landmarks like Notre-Dame over coffee.",
                "nature": "Parisians love their green spaces—join locals for a picnic in parks like Jardin des Tuileries to blend in.",
                "adventure": "Adventure in Paris often means embracing the unexpected—locals might recommend a spontaneous Seine cruise at sunset.",
                "shopping": "Shopping in Paris is an art form; locals often dress stylishly even for a quick trip to Le Marais boutiques.",
                "for-kids": "Parisians often take kids to educational yet fun spots like Parc de la Villette—join in for a local experience."
              },
              "walkingRoutes": {
                "art": "Start at the Louvre, walk along the Seine to Musée d’Orsay, and end at Musée Rodin for a full art immersion.",
                "history": "Begin at Notre-Dame, cross to Île de la Cité, then head to Sainte-Chapelle and the Conciergerie for a historic loop.",
                "nature": "Stroll from Jardin des Tuileries to Luxembourg Gardens, then relax at Jardin des Plantes for a nature-filled day.",
                "adventure": "Walk from the Eiffel Tower to the Seine for a river cruise, then head to the Paris Catacombs for an adventurous day.",
                "shopping": "Start at Galeries Lafayette, walk down the Champs-Élysées, and end in Le Marais for a shopping extravaganza.",
                "for-kids": "Begin at Jardin d’Acclimatation, walk to Aquarium de Paris, and end at Parc de la Villette for a kid-friendly route."
              },
              "packingChecklist": {
                "art": "Bring a sketchbook, comfortable shoes for museum walking, and a camera for capturing art-inspired moments.",
                "history": "Pack a history guidebook, comfortable walking shoes, and a light jacket for exploring historic sites.",
                "nature": "Bring a picnic blanket, sunscreen, and a hat for a day in Paris’s parks.",
                "adventure": "Pack comfortable shoes, a water bottle, and a camera for capturing adventurous moments like the Eiffel Tower Summit.",
                "shopping": "Bring a reusable shopping bag, comfortable shoes, and a credit card for a day of retail therapy.",
                "for-kids": "Pack snacks, a stroller if needed, and sun protection for a day of family fun."
              }
            }
          }
        }
      }
    };

    const exchangeRates = { "USD": 1, "EUR": 0.92 };

    function getExcitingTitle(type, name, interestOrType) {
      const activityTitles = {
        "art": "Dive into art at",
        "history": "Step back in time at",
        "nature": "Relax in nature at",
        "adventure": "Thrill your senses at",
        "shopping": "For a shopping spree visit",
        "for-kids": "Fun for kids at"
      };
      const mealTitles = {
        "French": "Savor French cuisine at",
        "Vegan": "Enjoy a vegan delight at",
        "Italian": "Taste Italy at",
        "Asian": "Spice up your day at",
        "Fast Food": "Grab a quick bite at",
        "Local Street Food": "Experience local flavors at",
        "Breakfast": "Start your day with breakfast at",
        "Brunch": "Enjoy a delightful brunch at",
        "Dessert": "Indulge in dessert at"
      };
      return type === "activity" ? `${activityTitles[interestOrType] || "Explore"}: ${name}` : `${mealTitles[interestOrType] || "Have an incredible meal at"}: ${name}`;
    }

    document.getElementById('travelForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const country = form.country.value;
      const city = form.city.value;
      const interests = homolog(form.interests.value) || "art";
      const food = homolog(form.food.value) || "French";
      const budget = form.budget.value;
      const currency = form.currency.value || "USD";
      const persons = parseInt(form.persons.value) || 1;
      const timeOfDay = homolog(form.timeOfDay.value) || "morning";
      const code = form.code.value.trim();
      const previewPremium = form.previewPremium.checked;
      let isPremium = code === 'TRAVEL2025' || previewPremium;

      function homolog(str) { return str === "" ? null : str; }

      if (!country || !city || !budget || !form.persons.value) {
        document.getElementById('output').innerHTML = '<p class="error">Please fill in all required fields.</p>';
        return;
      }

      const cityData = travelData[country].cities[city];
      let itinerary = `<h2>Your ${city} 1-Day Free Itinerary (${persons} Person${persons > 1 ? 's' : ''})</h2>`;
      let totalCost = 0;

      const convertCost = (cost) => Math.round(cost * exchangeRates[currency] * 100) / 100;

      const activities = cityData.activities[interests].filter(a => a.time === timeOfDay);
      const restaurants = cityData.restaurants[food].filter(r => r.budget === budget && r.time === timeOfDay);

      const activity = activities.length > 0 ? activities[0] : cityData.activities[interests][0];
      const restaurant = restaurants.length > 0 ? restaurants[0] : cityData.restaurants[food].find(r => r.budget === budget) || cityData.restaurants[food][0];

      let activityCostPerPerson = convertCost(activity.cost);
      let activityCostTotal = convertCost(activity.cost * persons);
      let restaurantCostPerPerson = convertCost(restaurant.cost);
      let restaurantCostTotal = convertCost(restaurant.cost * persons);
      totalCost = activityCostTotal + restaurantCostTotal;
      let totalCostPerPerson = totalCost / persons;

      let budgetLimit = { "low": 50, "medium": 150, "high": Infinity }[budget];
      if (totalCostPerPerson > budgetLimit) {
        itinerary += `<div class="budget-warning">`;
        itinerary += `<p>Warning: Total cost per person ($${totalCostPerPerson.toFixed(2)} ${currency}) exceeds your budget range of $${budgetLimit.toFixed(2)} ${currency}.</p>`;
        itinerary += `<button onclick="rearrangeItinerary('${country}', '${city}', '${interests}', '${food}', '${budget}', '${currency}', ${persons}, '${timeOfDay}', ${isPremium})">Rearrange to Fit Budget</button>`;
        itinerary += `</div>`;
      }

      itinerary += `<h3 class="day">Day 1 (Time of Day: ${timeOfDay.charAt(0).toUpperCase() + timeOfDay.slice(1)})</h3>`;
      itinerary += `<p><strong>Activity - ${getExcitingTitle("activity", activity.name, interests)}</strong> ($${activityCostPerPerson.toFixed(2)} ${currency} per person, $${activityCostTotal.toFixed(2)} ${currency} total, Nearest Metro: ${activity.nearestMetro}, Nearest Bus: ${activity.nearestBus}, <a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      itinerary += `<p><strong>Meal - ${getExcitingTitle("meal", restaurant.name, food)}</strong> ($${restaurantCostPerPerson.toFixed(2)} ${currency} per person, $${restaurantCostTotal.toFixed(2)} ${currency} total, Nearest Metro: ${restaurant.nearestMetro}, Nearest Bus: ${restaurant.nearestBus}, <a href="${restaurant.url}" target="_blank">${restaurant.url}</a>)</p>`;
      itinerary += `<p><strong>Total Estimated Cost:</strong> $${totalCost.toFixed(2)} ${currency} ($${totalCostPerPerson.toFixed(2)} ${currency} per person)</p>`;

      if (isPremium) {
        itinerary += `<h3 class="premium-extras">Premium Extras</h3>`;
        const secondaryActivities = cityData.premiumExtras.secondaryActivities.filter(a => a.time === timeOfDay && a.interest === interests);
        const secondaryActivity = secondaryActivities.length > 0 ? secondaryActivities[0] : cityData.premiumExtras.secondaryActivities.find(a => a.interest === interests) || cityData.premiumExtras.secondaryActivities[0];
        itinerary += `<p><strong>Extra Adventure - ${getExcitingTitle("activity", secondaryActivity.name, interests)}</strong> ($${convertCost(secondaryActivity.cost).toFixed(2)} ${currency} per person, $${convertCost(secondaryActivity.cost * persons).toFixed(2)} ${currency} total, Nearest Metro: ${secondaryActivity.nearestMetro}, Nearest Bus: ${secondaryActivity.nearestBus}, <a href="${secondaryActivity.url}" target="_blank">${secondaryActivity.url}</a>)</p>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="local-tips">Local Tips</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.localTips[timeOfDay][interests]}</p>`;
        itinerary += `</div>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="premium-extras">Cultural Insight</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.culturalInsights[interests]}</p>`;
        itinerary += `</div>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="premium-extras">Suggested Walking Route</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.walkingRoutes[interests]}</p>`;
        itinerary += `</div>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="premium-extras">Packing Checklist</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.packingChecklist[interests]}</p>`;
        itinerary += `</div>`;
      }

      itinerary += `<p class="upgrade">Upgrade to Premium (code: TRAVEL2025) for your full trip plan! <span id="paypal-button-placeholder">[PayPal Button Placeholder]</span></p>`;

      const recommendations = cityData.recommendations[budget];
      itinerary += `<div class="recommendations ${isPremium ? '' : 'hidden'}">`;
      itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
      itinerary += `<p><strong>Activities:</strong></p>`;
      let filteredActivities = recommendations.activities.filter(a => a.time === timeOfDay && a.interest === interests);
      if (filteredActivities.length === 0) {
        filteredActivities = recommendations.activities.filter(a => a.interest === interests);
        if (filteredActivities.length === 0) {
          filteredActivities = recommendations.activities; // Fallback to any activity if no matches
        }
      }
      filteredActivities.forEach(activity => {
        itinerary += `<p>- ${getExcitingTitle("activity", activity.name, interests)} ($${convertCost(activity.cost).toFixed(2)} ${currency} per person, $${convertCost(activity.cost * persons).toFixed(2)} ${currency} total, Nearest Metro: ${activity.nearestMetro}, Nearest Bus: ${activity.nearestBus}, <a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      });

      itinerary += `<p><strong>Dining:</strong></p>`;
      let filteredRestaurants = recommendations.restaurants.filter(r => r.time === timeOfDay && r.interest === interests);
      if (filteredRestaurants.length === 0) {
        if (timeOfDay === "morning") {
          filteredRestaurants = recommendations.restaurants.filter(r => (r.type === "Breakfast" || r.type === "Brunch") && r.interest === interests);
        } else if (timeOfDay === "afternoon") {
          filteredRestaurants = recommendations.restaurants.filter(r => r.type === "Dessert" && r.interest === interests);
        }
        if (filteredRestaurants.length === 0) {
          filteredRestaurants = recommendations.restaurants.filter(r => r.interest === interests);
          if (filteredRestaurants.length === 0) {
            filteredRestaurants = recommendations.restaurants; // Fallback to any restaurant if no matches
          }
        }
      }
      filteredRestaurants.forEach(restaurant => {
        itinerary += `<p>- ${getExcitingTitle("meal", restaurant.name, restaurant.type)} ($${convertCost(restaurant.cost).toFixed(2)} ${currency} per person, $${convertCost(restaurant.cost * persons).toFixed(2)} ${currency} total, Nearest Metro: ${restaurant.nearestMetro}, Nearest Bus: ${restaurant.nearestBus}, <a href="${restaurant.url}" target="_blank">${restaurant.url}</a>, ${restaurant.type})</p>`;
      });
      itinerary += `</div>`;

      if (!isPremium) {
        itinerary += `<div class="recommendations">`;
        itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
        itinerary += `<p>Unlock personalized recommendations by subscribing to premium! Enter the code TRAVEL2025 to see more.</p>`;
        itinerary += `</div>`;
      }

      document.getElementById('output').innerHTML = itinerary;
    });

    function rearrangeItinerary(country, city, interests, food, budget, currency, persons, timeOfDay, isPremium) {
      const cityData = travelData[country].cities[city];
      let itinerary = `<h2>Your ${city} 1-Day Free Itinerary (${persons} Person${persons > 1 ? 's' : ''}) - Rearranged to Fit Budget</h2>`;
      let totalCost = 0;

      const convertCost = (cost) => Math.round(cost * exchangeRates[currency] * 100) / 100;
      let budgetLimit = { "low": 50, "medium": 150, "high": Infinity }[budget];
      const remainingBudget = budgetLimit * persons;

      const activities = cityData.activities[interests];
      const activity = activities.find(a => a.cost * persons <= remainingBudget && a.time === timeOfDay) || activities[0];
      let activityCostTotal = convertCost(activity.cost * persons);
      let remainingAfterActivity = remainingBudget - activityCostTotal;

      const restaurants = cityData.restaurants[food];
      const restaurant = restaurants.find(r => r.cost * persons <= remainingAfterActivity && r.time === timeOfDay) || restaurants[0];
      let restaurantCostTotal = convertCost(restaurant.cost * persons);

      totalCost = activityCostTotal + restaurantCostTotal;
      const totalCostPerPerson = totalCost / persons;

      itinerary += `<h3 class="day">Day 1 (Time of Day: ${timeOfDay.charAt(0).toUpperCase() + timeOfDay.slice(1)})</h3>`;
      itinerary += `<p><strong>Activity - ${getExcitingTitle("activity", activity.name, interests)}</strong> ($${convertCost(activity.cost).toFixed(2)} ${currency} per person, $${activityCostTotal.toFixed(2)} ${currency} total, Nearest Metro: ${activity.nearestMetro}, Nearest Bus: ${activity.nearestBus}, <a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      itinerary += `<p><strong>Meal - ${getExcitingTitle("meal", restaurant.name, food)}</strong> ($${convertCost(restaurant.cost).toFixed(2)} ${currency} per person, $${restaurantCostTotal.toFixed(2)} ${currency} total, Nearest Metro: ${restaurant.nearestMetro}, Nearest Bus: ${restaurant.nearestBus}, <a href="${restaurant.url}" target="_blank">${restaurant.url}</a>)</p>`;
      itinerary += `<p><strong>Total Estimated Cost:</strong> $${totalCost.toFixed(2)} ${currency} ($${totalCostPerPerson.toFixed(2)} ${currency} per person)</p>`;

      if (isPremium) {
        itinerary += `<h3 class="premium-extras">Premium Extras</h3>`;
        const secondaryActivity = cityData.premiumExtras.secondaryActivities.find(a => a.time === timeOfDay && a.interest === interests) || cityData.premiumExtras.secondaryActivities[0];
        itinerary += `<p><strong>Extra Adventure - ${getExcitingTitle("activity", secondaryActivity.name, interests)}</strong> ($${convertCost(secondaryActivity.cost).toFixed(2)} ${currency} per person, $${convertCost(secondaryActivity.cost * persons).toFixed(2)} ${currency} total, Nearest Metro: ${secondaryActivity.nearestMetro}, Nearest Bus: ${secondaryActivity.nearestBus}, <a href="${secondaryActivity.url}" target="_blank">${secondaryActivity.url}</a>)</p>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="local-tips">Local Tips</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.localTips[timeOfDay][interests]}</p>`;
        itinerary += `</div>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="premium-extras">Cultural Insight</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.culturalInsights[interests]}</p>`;
        itinerary += `</div>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="premium-extras">Suggested Walking Route</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.walkingRoutes[interests]}</p>`;
        itinerary += `</div>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="premium-extras">Packing Checklist</h3>`;
        itinerary += `<p>- ${cityData.premiumExtras.packingChecklist[interests]}</p>`;
        itinerary += `</div>`;
      }

      itinerary += `<p class="upgrade">Upgrade to Premium (code: TRAVEL2025) for your full trip plan! <span id="paypal-button-placeholder">[PayPal Button Placeholder]</span></p>`;

      const recommendations = cityData.recommendations[budget];
      itinerary += `<div class="recommendations ${isPremium ? '' : 'hidden'}">`;
      itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
      itinerary += `<p><strong>Activities:</strong></p>`;
      let filteredActivities = recommendations.activities.filter(a => a.time === timeOfDay && a.interest === interests);
      if (filteredActivities.length === 0) {
        filteredActivities = recommendations.activities.filter(a => a.interest === interests);
        if (filteredActivities.length === 0) {
          filteredActivities = recommendations.activities;
        }
      }
      filteredActivities.forEach(activity => {
        itinerary += `<p>- ${getExcitingTitle("activity", activity.name, interests)} ($${convertCost(activity.cost).toFixed(2)} ${currency} per person, $${convertCost(activity.cost * persons).toFixed(2)} ${currency} total, Nearest Metro: ${activity.nearestMetro}, Nearest Bus: ${activity.nearestBus}, <a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      });

      itinerary += `<p><strong>Dining:</strong></p>`;
      let filteredRestaurants = recommendations.restaurants.filter(r => r.time === timeOfDay && r.interest === interests);
      if (filteredRestaurants.length === 0) {
        if (timeOfDay === "morning") {
          filteredRestaurants = recommendations.restaurants.filter(r => (r.type === "Breakfast" || r.type === "Brunch") && r.interest === interests);
        } else if (timeOfDay === "afternoon") {
          filteredRestaurants = recommendations.restaurants.filter(r => r.type === "Dessert" && r.interest === interests);
        }
        if (filteredRestaurants.length === 0) {
          filteredRestaurants = recommendations.restaurants.filter(r => r.interest === interests);
          if (filteredRestaurants.length === 0) {
            filteredRestaurants = recommendations.restaurants;
          }
        }
      }
      filteredRestaurants.forEach(restaurant => {
        itinerary += `<p>- ${getExcitingTitle("meal", restaurant.name, restaurant.type)} ($${convertCost(restaurant.cost).toFixed(2)} ${currency} per person, $${convertCost(restaurant.cost * persons).toFixed(2)} ${currency} total, Nearest Metro: ${restaurant.nearestMetro}, Nearest Bus: ${restaurant.nearestBus}, <a href="${restaurant.url}" target="_blank">${restaurant.url}</a>, ${restaurant.type})</p>`;
      });
      itinerary += `</div>`;

      if (!isPremium) {
        itinerary += `<div class="recommendations">`;
        itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
        itinerary += `<p>Unlock personalized recommendations by subscribing to premium! Enter the code TRAVEL2025 to see more.</p>`;
        itinerary += `</div>`;
      }

      document.getElementById('output').innerHTML = itinerary;
    }
  </script>
</body>
</html>
