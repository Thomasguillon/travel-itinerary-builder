<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Itinerary Builder - Paris, France</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background: url('https://images.unsplash.com/photo-1594643435935-eb2a4b3b7594?q=80&w=2070&auto=format&fit=crop') no-repeat center center fixed;
      background-size: cover;
      line-height: 1.6;
      color: #333;
      position: relative;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.4);
      z-index: -1;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 0 15px;
    }
    h1, h2 {
      text-align: center;
      color: #fff;
      margin-bottom: 20px;
    }
    h3 {
      text-align: center;
      margin-bottom: 10px;
    }
    h3.day {
      color: #ff4500; /* OrangeRed for Day 1 */
    }
    h3.local-tips {
      color: #ff6347; /* Tomato red for Local Tips */
    }
    h3.premium-extras {
      color: #4682b4; /* Steel blue for Premium Extras */
    }
    h3.recommendations {
      color: #32cd32; /* Lime green for Recommendations */
    }
    p.subtitle {
      text-align: center;
      color: #f0f0f0;
      margin-bottom: 20px;
    }
    form {
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }
    .form-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    label {
      width: 150px;
      font-weight: bold;
      color: #333;
    }
    select, input, button {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
      flex: 1;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0056b3;
    }
    #output {
      margin-top: 20px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    .error {
      color: #d9534f;
      font-weight: bold;
    }
    .budget-warning {
      background-color: #fff3cd;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .budget-warning button {
      margin-top: 10px;
      background-color: #28a745;
      padding: 5px 10px;
      font-size: 14px;
    }
    .budget-warning button:hover {
      background-color: #218838;
    }
    .upgrade {
      margin-top: 15px;
      font-style: italic;
      text-align: center;
    }
    .recommendations {
      margin-top: 20px;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 8px;
    }
    .local-tip {
      margin-top: 20px;
      padding: 15px;
      background-color: #e6f3ff;
      border-radius: 8px;
    }
    .hidden {
      display: none;
    }
    a {
      color: #007bff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    @media (max-width: 600px) {
      .container {
        padding: 0 10px;
      }
      h1 {
        font-size: 24px;
      }
      h2, h3 {
        font-size: 20px;
      }
      form, #output {
        padding: 15px;
      }
      .form-row {
        flex-direction: column;
        align-items: flex-start;
      }
      label {
        width: auto;
      }
      select, input, button {
        font-size: 14px;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Travel Itinerary Builder - Paris, France</h1>
    <p class="subtitle">Choose your preferences to get a 1-day free itinerary for Paris, France. Upgrade to premium for more options!</p>
    <form id="travelForm">
      <div class="form-row">
        <label for="countrySelect">Country:</label>
        <select name="country" id="countrySelect" required>
          <option value="France" selected>France</option>
        </select>
      </div>
      <div class="form-row">
        <label for="citySelect">City:</label>
        <select name="city" id="citySelect" required>
          <option value="Paris" selected>Paris</option>
        </select>
      </div>
      <div class="form-row">
        <label for="location">Starting Location:</label>
        <input type="text" name="location" placeholder="e.g., Eiffel Tower, Paris" required>
      </div>
      <div class="form-row">
        <label for="interests">Interests:</label>
        <select name="interests">
          <option value="" selected>Any Interest</option>
          <option value="art">Art</option>
          <option value="history">History</option>
          <option value="nature">Nature</option>
          <option value="adventure">Adventure</option>
          <option value="shopping">Shopping</option>
          <option value="for-kids">For Kids</option>
        </select>
      </div>
      <div class="form-row">
        <label for="transport">Transport:</label>
        <select name="transport">
          <option value="" selected>Any Transport</option>
          <option value="metro">Metro</option>
          <option value="taxi">Taxi</option>
          <option value="train">Train</option>
          <option value="tramway">Tramway</option>
        </select>
      </div>
      <div class="form-row">
        <label for="food">Food:</label>
        <select name="food">
          <option value="" selected>Any Food</option>
          <option value="French">French</option>
          <option value="Vegan">Vegan</option>
          <option value="Italian">Italian</option>
          <option value="Asian">Asian</option>
          <option value="Fast Food">Fast Food</option>
          <option value="Local Street Food">Local Street Food</option>
        </select>
      </div>
      <div class="form-row">
        <label for="budget">Budget (per person):</label>
        <select name="budget" required>
          <option value="" disabled selected>Select Budget Range</option>
          <option value="low">Low ($0-50)</option>
          <option value="medium">Medium ($51-150)</option>
          <option value="high">High ($151+)</option>
        </select>
      </div>
      <div class="form-row">
        <label for="currency">Currency:</label>
        <select name="currency">
          <option value="" selected>USD (Default)</option>
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
        </select>
      </div>
      <div class="form-row">
        <label for="persons">Number of Persons:</label>
        <select name="persons" required>
          <option value="" disabled selected>Select Number of Persons</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4+">4 or more</option>
        </select>
      </div>
      <div class="form-row">
        <label for="timeOfDay">Time of Day:</label>
        <select name="timeOfDay">
          <option value="" selected>Any Time</option>
          <option value="morning">Morning</option>
          <option value="afternoon">Afternoon</option>
          <option value="evening">Evening</option>
        </select>
      </div>
      <div class="form-row">
        <label for="code">Premium Code:</label>
        <input type="text" name="code" placeholder="Premium Code (optional)">
      </div>
      <div class="form-row">
        <label for="previewPremium">Preview Premium:</label>
        <label><input type="checkbox" name="previewPremium" value="true"> Preview Premium Features (For Testing)</label>
      </div>
      <button type="submit">Generate Itinerary</button>
    </form>
    <div id="output"></div>
  </div>

  <script>
    // Static JSON data for France (Paris only)
    const travelData = {
      "France": {
        "cities": {
          "Paris": {
            "transport": {
              "metro": { "cost": 2.3, "url": "https://www.ratp.fr/en", "details": { "baseTime": 20, "baseStops": "Châtelet to Louvre-Rivoli", "station": "Louvre-Rivoli (Line 1)" } },
              "taxi": { "cost": 16, "url": "https://www.paris.fr/en/pages/taxis-2415", "details": { "baseTime": 15, "baseStops": "Direct" } },
              "train": { "cost": 3.5, "url": "https://www.sncf.com/en", "details": { "baseTime": 30, "baseStops": "Gare du Nord to Saint-Michel Notre-Dame", "station": "Saint-Michel Notre-Dame (RER B)" } },
              "tramway": { "cost": 2.3, "url": "https://www.ratp.fr/en", "details": { "baseTime": 25, "baseStops": "Porte de Vincennes to Porte de la Chapelle", "station": "Porte de la Chapelle (T3b)" } }
            },
            "restaurants": {
              "French": [
                { "budget": "low", "name": "Chez Gladines", "cost": 15, "url": "https://www.chezgladines.fr/", "time": "afternoon", "interest": "history", "location": "30 Rue des Cinq Diamants" },
                { "budget": "medium", "name": "Brasserie Lipp", "cost": 50, "url": "https://www.brasserielipp.fr/en/", "time": "evening", "interest": "history", "location": "151 Boulevard Saint-Germain" },
                { "budget": "high", "name": "Le Jules Verne", "cost": 150, "url": "https://www.restaurants-toureiffel.com/en/le-jules-verne.html", "time": "evening", "interest": "adventure", "location": "Eiffel Tower, Champ de Mars" }
              ],
              "Vegan": [
                { "budget": "low", "name": "Le Grenier de Notre-Dame", "cost": 20, "url": "https://www.legrenierdenotredame.fr/", "time": "afternoon", "interest": "nature", "location": "18 Rue de la Bûcherie" },
                { "budget": "medium", "name": "Le Potager de Charlotte", "cost": 30, "url": "https://www.lepotagerdecharlotte.fr/en/", "time": "evening", "interest": "nature", "location": "12 Rue de la Tour d'Auvergne" },
                { "budget": "high", "name": "Gentle Gourmet", "cost": 60, "url": "https://www.gentlegourmet.fr/", "time": "evening", "interest": "nature", "location": "24 Boulevard de la Bastille" }
              ],
              "Italian": [
                { "budget": "low", "name": "Pizza Julia", "cost": 15, "url": "https://www.pizzajulia.fr/", "time": "afternoon", "interest": "shopping", "location": "43 Rue de Charenton" },
                { "budget": "medium", "name": "Pizzeria Popolare", "cost": 25, "url": "https://www.bigmammagroup.com/en/trattorias/pizzeria-popolare", "time": "evening", "interest": "shopping", "location": "111 Rue Réaumur" },
                { "budget": "high", "name": "Il Vicolo", "cost": 55, "url": "https://www.ilvicolo-paris.fr/", "time": "evening", "interest": "shopping", "location": "15 Rue de Birague" }
              ],
              "Asian": [
                { "budget": "low", "name": "Kodawari Ramen", "cost": 20, "url": "https://www.kodawari-ramen.com/", "time": "afternoon", "interest": "adventure", "location": "29 Rue Mazarine" },
                { "budget": "medium", "name": "Miss Kô", "cost": 40, "url": "https://www.miss-ko.com/", "time": "evening", "interest": "adventure", "location": "49 Avenue George V" },
                { "budget": "high", "name": "Shang Palace", "cost": 80, "url": "https://www.shangri-la.com/paris/shangrila/dining/restaurants/shang-palace/", "time": "evening", "interest": "adventure", "location": "10 Avenue d'Iéna" }
              ],
              "Fast Food": [
                { "budget": "low", "name": "McDonald’s", "cost": 10, "url": "https://www.mcdonalds.fr/", "time": "afternoon", "interest": "for-kids", "location": "140 Avenue des Champs-Élysées" },
                { "budget": "medium", "name": "Five Guys", "cost": 15, "url": "https://www.fiveguys.fr/", "time": "evening", "interest": "for-kids", "location": "46 Cour Saint-Émilion" },
                { "budget": "high", "name": "Shake Shack", "cost": 20, "url": "https://www.shakeshack.com/", "time": "evening", "interest": "for-kids", "location": "Paris location TBD" }
              ],
              "Local Street Food": [
                { "budget": "low", "name": "Chez Alain Miam Miam", "cost": 10, "url": "https://www.paris.fr/pages/chez-alain-miam-miam-2415", "time": "afternoon", "interest": "art", "location": "Marché Saint-Germain" },
                { "budget": "medium", "name": "Marché des Enfants Rouges", "cost": 12, "url": "https://www.paris.fr/lieux/marche-des-enfants-rouges-1799", "time": "morning", "interest": "art", "location": "39 Rue de Birague" },
                { "budget": "high", "name": "Le Food Market", "cost": 20, "url": "https://www.lefoodmarket.fr/", "time": "evening", "interest": "art", "location": "Boulevard de Belleville" }
              ]
            },
            "activities": {
              "art": [
                { "name": "Louvre Museum", "cost": 20, "url": "https://www.louvre.fr/en", "time": "morning", "location": "Rue de Rivoli" },
                { "name": "Musée d’Orsay", "cost": 14, "url": "https://www.musee-orsay.fr/en", "time": "afternoon", "location": "1 Rue de la Légion d'Honneur" },
                { "name": "Centre Pompidou", "cost": 15, "url": "https://www.centrepompidou.fr/en/", "time": "afternoon", "location": "Place Georges-Pompidou" },
                { "name": "Musée Rodin", "cost": 12, "url": "https://www.musee-rodin.fr/en", "time": "morning", "location": "77 Rue de Varenne" },
                { "name": "Musée de l’Orangerie", "cost": 12.5, "url": "https://www.musee-orangerie.fr/en", "time": "afternoon", "location": "Jardin des Tuileries" }
              ],
              "history": [
                { "name": "Notre-Dame Cathedral", "cost": 0, "url": "https://www.notredamedeparis.fr/en/", "time": "morning", "location": "6 Parvis Notre-Dame" },
                { "name": "Palace of Versailles", "cost": 19.5, "url": "https://en.chateauversailles.fr/", "time": "afternoon", "location": "Place d'Armes, Versailles" },
                { "name": "Sainte-Chapelle", "cost": 11.5, "url": "https://www.sainte-chapelle.fr/en/", "time": "morning", "location": "8 Boulevard du Palais" },
                { "name": "The Conciergerie", "cost": 9, "url": "https://www.paris-conciergerie.fr/en/", "time": "afternoon", "location": "2 Boulevard du Palais" },
                { "name": "Les Invalides", "cost": 14, "url": "https://www.musee-armee.fr/en/", "time": "afternoon", "location": "129 Rue de Grenelle" }
              ],
              "nature": [
                { "name": "Jardin des Tuileries", "cost": 0, "url": "https://www.paris.fr/lieux/jardin-des-tuileries-1795", "time": "morning", "location": "Place de la Concorde" },
                { "name": "Bois de Boulogne", "cost": 0, "url": "https://www.paris.fr/lieux/bois-de-boulogne-2468", "time": "afternoon", "location": "Route de Suresnes" },
                { "name": "Luxembourg Gardens", "cost": 0, "url": "https://www.paris.fr/lieux/jardin-du-luxembourg-1807", "time": "morning", "location": "Rue de Médicis" },
                { "name": "Parc des Buttes-Chaumont", "cost": 0, "url": "https://www.paris.fr/lieux/parc-des-buttes-chaumont-1802", "time": "afternoon", "location": "1 Rue Botzaris" },
                { "name": "Jardin des Plantes", "cost": 0, "url": "https://www.jardindesplantesdeparis.fr/en", "time": "morning", "location": "57 Rue Cuvier" }
              ],
              "adventure": [
                { "name": "Seine River Cruise", "cost": 15, "url": "https://www.bateauxparisiens.com/en/", "time": "evening", "location": "Port de la Bourdonnais" },
                { "name": "Eiffel Tower Summit", "cost": 26, "url": "https://www.toureiffel.paris/en", "time": "afternoon", "location": "Champ de Mars" },
                { "name": "Paris Catacombs Tour", "cost": 29, "url": "https://www.catacombes.paris.fr/en/", "time": "morning", "location": "1 Avenue du Colonel Henri Rol-Tanguy" },
                { "name": "Bike Tour of Paris", "cost": 35, "url": "https://www.fattiretours.com/paris", "time": "afternoon", "location": "24 Rue Edgar Faure" },
                { "name": "Hot Air Balloon Ride", "cost": 250, "url": "https://www.ballondeparis.com/en/", "time": "morning", "location": "Parc André Citroën" }
              ],
              "shopping": [
                { "name": "Galeries Lafayette", "cost": 0, "url": "https://www.galerieslafayette.com/en/", "time": "afternoon", "location": "40 Boulevard Haussmann" },
                { "name": "Champs-Élysées", "cost": 0, "url": "https://www.paris.fr/lieux/avenue-des-champs-elysees-1793", "time": "evening", "location": "Avenue des Champs-Élysées" },
                { "name": "Le Marais Boutiques", "cost": 0, "url": "https://www.paris.fr/lieux/le-marais-1801", "time": "afternoon", "location": "Rue de Birague" },
                { "name": "Marché aux Puces", "cost": 0, "url": "https://marcheauxpuces-saintouen.com/en/", "time": "morning", "location": "Rue des Rosiers, Saint-Ouen" },
                { "name": "Passage des Panoramas", "cost": 0, "url": "https://www.paris.fr/lieux/passage-des-panoramas-1803", "time": "afternoon", "location": "11 Boulevard Montmartre" }
              ],
              "for-kids": [
                { "name": "Disneyland Paris", "cost": 60, "url": "https://www.disneylandparis.com/en-us/", "time": "afternoon", "location": "Chessy, Marne-la-Vallée" },
                { "name": "Parc de la Villette - Cité des Enfants", "cost": 12, "url": "https://www.cite-sciences.fr/en/children", "time": "morning", "location": "30 Avenue Corentin Cariou" },
                { "name": "Jardin d’Acclimatation", "cost": 5, "url": "https://www.jardindacclimatation.fr/en", "time": "afternoon", "location": "Bois de Boulogne" },
                { "name": "Paris Zoo (Parc Zoologique)", "cost": 20, "url": "https://www.parczoologiquedeparis.fr/en", "time": "morning", "location": "Avenue Daumesnil" },
                { "name": "Aquarium de Paris", "cost": 25, "url": "https://www.aquariumdeparis.com/en", "time": "afternoon", "location": "5 Avenue Albert de Mun" }
              ]
            },
            "recommendations": {
              "low": {
                "activities": [
                  { "name": "Walk along the Seine", "cost": 0, "url": "https://www.paris.fr/lieux/quais-de-seine-1798", "interest": "art", "time": "morning", "location": "Quai de la Rapée" },
                  { "name": "Picnic at Luxembourg Gardens", "cost": 5, "url": "https://www.paris.fr/lieux/jardin-du-luxembourg-1807", "interest": "nature", "time": "afternoon", "location": "Rue de Médicis" },
                  { "name": "Visit Montmartre", "cost": 0, "url": "https://www.paris.fr/lieux/montmartre-1800", "interest": "history", "time": "evening", "location": "Place du Tertre" },
                  { "name": "Jardin d’Acclimatation", "cost": 5, "url": "https://www.jardindacclimatation.fr/en", "interest": "for-kids", "time": "afternoon", "location": "Bois de Boulogne" }
                ],
                "restaurants": [
                  { "name": "Chez Gladines", "cost": 15, "url": "https://www.chezgladines.fr/", "type": "French", "interest": "history", "time": "afternoon", "location": "30 Rue des Cinq Diamants" },
                  { "name": "Chez Alain Miam Miam", "cost": 10, "url": "https://www.paris.fr/pages/chez-alain-miam-miam-2415", "type": "Local Street Food", "interest": "art", "time": "afternoon", "location": "Marché Saint-Germain" },
                  { "name": "McDonald’s", "cost": 10, "url": "https://www.mcdonalds.fr/", "type": "Fast Food", "interest": "for-kids", "time": "afternoon", "location": "140 Avenue des Champs-Élysées" }
                ]
              },
              "medium": {
                "activities": [
                  { "name": "Seine River Cruise", "cost": 15, "url": "https://www.bateauxparisiens.com/en/", "interest": "adventure", "time": "evening", "location": "Port de la Bourdonnais" },
                  { "name": "Musée Rodin", "cost": 12, "url": "https://www.musee-rodin.fr/en", "interest": "art", "time": "morning", "location": "77 Rue de Varenne" },
                  { "name": "Sainte-Chapelle", "cost": 11.5, "url": "https://www.sainte-chapelle.fr/en/", "interest": "history", "time": "morning", "location": "8 Boulevard du Palais" },
                  { "name": "Parc de la Villette - Cité des Enfants", "cost": 12, "url": "https://www.cite-sciences.fr/en/children", "interest": "for-kids", "time": "morning", "location": "30 Avenue Corentin Cariou" }
                ],
                "restaurants": [
                  { "name": "Le Potager de Charlotte", "cost": 30, "url": "https://www.lepotagerdecharlotte.fr/en/", "type": "Vegan", "interest": "nature", "time": "evening", "location": "12 Rue de la Tour d'Auvergne" },
                  { "name": "Pizzeria Popolare", "cost": 25, "url": "https://www.bigmammagroup.com/en/trattorias/pizzeria-popolare", "type": "Italian", "interest": "shopping", "time": "evening", "location": "111 Rue Réaumur" },
                  { "name": "Miss Kô", "cost": 40, "url": "https://www.miss-ko.com/", "type": "Asian", "interest": "adventure", "time": "evening", "location": "49 Avenue George V" }
                ]
              },
              "high": {
                "activities": [
                  { "name": "Eiffel Tower Summit", "cost": 26, "url": "https://www.toureiffel.paris/en", "interest": "adventure", "time": "afternoon", "location": "Champ de Mars" },
                  { "name": "Palace of Versailles", "cost": 19.5, "url": "https://en.chateauversailles.fr/", "interest": "history", "time": "afternoon", "location": "Place d'Armes, Versailles" },
                  { "name": "Lido de Paris Cabaret Show", "cost": 85, "url": "https://www.lido.fr/en/", "interest": "adventure", "time": "evening", "location": "116 Avenue des Champs-Élysées" },
                  { "name": "Disneyland Paris", "cost": 60, "url": "https://www.disneylandparis.com/en-us/", "interest": "for-kids", "time": "afternoon", "location": "Chessy, Marne-la-Vallée" }
                ],
                "restaurants": [
                  { "name": "Le Jules Verne", "cost": 150, "url": "https://www.restaurants-toureiffel.com/en/le-jules-verne.html", "type": "French", "interest": "adventure", "time": "evening", "location": "Eiffel Tower, Champ de Mars" },
                  { "name": "Shang Palace", "cost": 80, "url": "https://www.shangri-la.com/paris/shangrila/dining/restaurants/shang-palace/", "type": "Asian", "interest": "adventure", "time": "evening", "location": "10 Avenue d'Iéna" },
                  { "name": "Gentle Gourmet", "cost": 60, "url": "https://www.gentlegourmet.fr/", "type": "Vegan", "interest": "nature", "time": "evening", "location": "24 Boulevard de la Bastille" }
                ]
              }
            },
            "premiumExtras": {
              "secondaryActivities": [
                { "name": "Visit the Latin Quarter", "cost": 0, "url": "https://www.paris.fr/lieux/quartier-latin-1804", "time": "afternoon", "interest": "history", "location": "Place Saint-Michel" },
                { "name": "Explore Île de la Cité", "cost": 0, "url": "https://www.paris.fr/lieux/ile-de-la-cite-1805", "time": "morning", "interest": "history", "location": "Île de la Cité" },
                { "name": "Puppet Show at Luxembourg Gardens", "cost": 6, "url": "https://www.paris.fr/lieux/jardin-du-luxembourg-1807", "time": "afternoon", "interest": "for-kids", "location": "Rue de Médicis" }
              ],
              "localTips": [
                "Visit the Eiffel Tower early in the morning to avoid crowds.",
                "Try a hidden gem: the Canal Saint-Martin for a scenic walk and local cafes.",
                "The best time to visit the Louvre is on Wednesday or Friday evening when it’s open late and less crowded.",
                "For kids, the Jardin d’Acclimatation has a petting zoo that’s a hidden delight!"
              ]
            }
          }
        }
      }
    };

    // Currency conversion rates (as of March 2025, approximate)
    const exchangeRates = {
      "USD": 1,
      "EUR": 0.92 // 1 USD = 0.92 EUR
    };

    // Simulated distance and time calculation (in minutes/km)
    const transportModifiers = {
      "metro": { timePerKm: 2, costPerKm: 0.1 },
      "taxi": { timePerKm: 1.5, costPerKm: 1.5 },
      "train": { timePerKm: 1.8, costPerKm: 0.15 },
      "tramway": { timePerKm: 2.5, costPerKm: 0.1 }
    };

    // Simulated distances from common Paris locations (in km)
    const locationDistances = {
      "Eiffel Tower": {
        "Champ de Mars": 0, "Rue de Rivoli": 3, "140 Avenue des Champs-Élysées": 2, "Chessy, Marne-la-Vallée": 32
      },
      "Notre-Dame": {
        "6 Parvis Notre-Dame": 0, "Rue de Rivoli": 1, "Champ de Mars": 4, "Chessy, Marne-la-Vallée": 35
      },
      "Montmartre": {
        "Place du Tertre": 0, "Rue de Rivoli": 3, "Champ de Mars": 5, "Chessy, Marne-la-Vallée": 30
      }
      // Add more as needed
    };

    function calculateTransport(startLocation, endLocation, transportType) {
      const startKey = Object.keys(locationDistances).find(key => startLocation.toLowerCase().includes(key.toLowerCase())) || "Eiffel Tower";
      const distance = locationDistances[startKey][endLocation] || 5; // Default 5km if not found
      const modifier = transportModifiers[transportType];
      const time = Math.round(distance * modifier.timePerKm);
      const extraCost = distance * modifier.costPerKm;
      const baseCost = travelData["France"].cities["Paris"].transport[transportType].cost;
      return {
        time: `${time} min`,
        cost: baseCost + extraCost,
        stops: travelData["France"].cities["Paris"].transport[transportType].details.baseStops,
        station: travelData["France"].cities["Paris"].transport[transportType].details.station || "N/A"
      };
    }

    // Function to find the cheapest option within budget
    function findCheapestOption(options, budgetLimit, persons, timeOfDay, interest, type) {
      const budgetLimitPerPerson = budgetLimit / persons;
      let cheapestOption = null;
      let lowestCost = Infinity;

      options.forEach(option => {
        const costPerPerson = option.cost;
        if (costPerPerson <= budgetLimitPerPerson && costPerPerson < lowestCost) {
          if (type === "activity" || type === "restaurant") {
            if (option.time === timeOfDay && (!interest || option.interest === interest)) {
              lowestCost = costPerPerson;
              cheapestOption = option;
            }
          } else {
            lowestCost = costPerPerson;
            cheapestOption = option;
          }
        }
      });

      return cheapestOption || options[0]; // Fallback to first option if none fit
    }

    // Form submission logic
    document.getElementById('travelForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const country = form.country.value;
      const city = form.city.value;
      const startLocation = form.location.value;
      const interests = form.interests.value || "art";
      const transport = form.transport.value || "metro";
      const food = form.food.value || "French";
      const budget = form.budget.value;
      const currency = form.currency.value || "USD";
      const persons = parseInt(form.persons.value) || 1;
      const timeOfDay = form.timeOfDay.value || "morning";
      const code = form.code.value.trim();
      const previewPremium = form.previewPremium.checked;
      let isPremium = code === 'TRAVEL2025' || previewPremium;

      // Validate required inputs
      if (!country || !city || !travelData[country] || !travelData[country].cities[city] || !startLocation) {
        document.getElementById('output').innerHTML = '<p class="error">Please fill in all required fields.</p>';
        return;
      }
      if (!budget) {
        document.getElementById('output').innerHTML = '<p class="error">Please select your budget range.</p>';
        return;
      }
      if (!form.persons.value) {
        document.getElementById('output').innerHTML = '<p class="error">Please select the number of persons.</p>';
        return;
      }

      const cityData = travelData[country].cities[city];
      let itinerary = `<h2>Your ${city} 1-Day Free Itinerary (${persons} Person${persons > 1 ? 's' : ''})</h2>`;
      let totalCost = 0;
      let transportOption, activity, restaurant;

      // Convert costs to selected currency
      const convertCost = (cost) => {
        const costInUSD = cost;
        const costInSelectedCurrency = costInUSD * exchangeRates[currency];
        return Math.round(costInSelectedCurrency * 100) / 100;
      };

      // Select activity and restaurant
      const activities = cityData.activities[interests].filter(activity => activity.time === timeOfDay);
      activity = activities.length > 0 ? activities[0] : cityData.activities[interests][0];
      const restaurants = cityData.restaurants[food].filter(restaurant => 
        restaurant.budget === budget && restaurant.time === timeOfDay
      );
      restaurant = restaurants.length > 0 ? restaurants[0] : cityData.restaurants[food].find(r => r.budget === budget) || cityData.restaurants[food][0];

      // Calculate transport costs and times (premium only)
      const transportToActivity = isPremium ? calculateTransport(startLocation, activity.location, transport) : null;
      const transportToRestaurant = isPremium ? calculateTransport(activity.location, restaurant.location, transport) : null;

      // Calculate costs
      let activityCostPerPerson = convertCost(activity.cost);
      let activityCostTotal = convertCost(activity.cost * persons);
      let restaurantCostPerPerson = convertCost(restaurant.cost);
      let restaurantCostTotal = convertCost(restaurant.cost * persons);
      let transportCostTotal = isPremium ? convertCost((transportToActivity.cost + transportToRestaurant.cost) * persons) : 0;
      totalCost = activityCostTotal + restaurantCostTotal + transportCostTotal;
      let totalCostPerPerson = totalCost / persons;

      // Check budget constraints
      let budgetLimit;
      switch (budget) {
        case "low": budgetLimit = 50; break;
        case "medium": budgetLimit = 150; break;
        case "high": budgetLimit = Infinity; break;
      }

      if (totalCostPerPerson > budgetLimit) {
        itinerary += `<div class="budget-warning">`;
        itinerary += `<p>Warning: Total cost per person ($${totalCostPerPerson.toFixed(2)} ${currency}) exceeds your budget range of $${budgetLimit.toFixed(2)} ${currency}.</p>`;
        itinerary += `<button onclick="rearrangeItinerary('${country}', '${city}', '${startLocation}', '${interests}', '${transport}', '${food}', '${budget}', '${currency}', ${persons}, '${timeOfDay}', ${isPremium})">Rearrange to Fit Budget</button>`;
        itinerary += `</div>`;
      }

      itinerary += `<h3 class="day">Day 1 (Time of Day: ${timeOfDay.charAt(0).toUpperCase() + timeOfDay.slice(1)})</h3>`;
      if (!isPremium) {
        itinerary += `<p><strong>Location:</strong> Starting from ${startLocation}</p>`;
        itinerary += `<p><strong>Transport:</strong> Detailed transport options (time, cost, stops) available with premium subscription!</p>`;
      } else {
        itinerary += `<p><strong>Location:</strong> Starting from ${startLocation}</p>`;
        itinerary += `<p><strong>Transport to Activity (${activity.name}):</strong> ${transport} - $${convertCost(transportToActivity.cost).toFixed(2)} ${currency} per person ($${convertCost(transportToActivity.cost * persons).toFixed(2)} ${currency} total), Time: ${transportToActivity.time}, Stops: ${transportToActivity.stops}, Station: ${transportToActivity.station}, <a href="${cityData.transport[transport].url}" target="_blank">${cityData.transport[transport].url}</a></p>`;
        itinerary += `<p><strong>Transport to Meal (${restaurant.name}):</strong> ${transport} - $${convertCost(transportToRestaurant.cost).toFixed(2)} ${currency} per person ($${convertCost(transportToRestaurant.cost * persons).toFixed(2)} ${currency} total), Time: ${transportToRestaurant.time}, Stops: ${transportToRestaurant.stops}, Station: ${transportToRestaurant.station}, <a href="${cityData.transport[transport].url}" target="_blank">${cityData.transport[transport].url}</a></p>`;
      }
      itinerary += `<p><strong>Activity:</strong> ${activity.name} ($${activityCostPerPerson.toFixed(2)} ${currency} per person, $${activityCostTotal.toFixed(2)} ${currency} total, <a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      itinerary += `<p><strong>Meal:</strong> ${restaurant.name} ($${restaurantCostPerPerson.toFixed(2)} ${currency} per person, $${restaurantCostTotal.toFixed(2)} ${currency} total, <a href="${restaurant.url}" target="_blank">${restaurant.url}</a>)</p>`;
      itinerary += `<p><strong>Total Estimated Cost:</strong> $${totalCost.toFixed(2)} ${currency} ($${totalCostPerPerson.toFixed(2)} ${currency} per person)</p>`;

      // Premium Extras
      if (isPremium) {
        itinerary += `<h3 class="premium-extras">Premium Extras</h3>`;
        itinerary += `<p><strong>Secondary Activity Suggestion:</strong></p>`;
        const secondaryActivities = cityData.premiumExtras.secondaryActivities.filter(activity => 
          activity.time === timeOfDay && activity.interest === interests
        );
        const secondaryActivity = secondaryActivities.length > 0 ? secondaryActivities[0] : cityData.premiumExtras.secondaryActivities.find(a => a.interest === interests) || cityData.premiumExtras.secondaryActivities[0];
        const transportToSecondary = calculateTransport(restaurant.location, secondaryActivity.location, transport);
        itinerary += `<p>- ${secondaryActivity.name} ($${convertCost(secondaryActivity.cost).toFixed(2)} ${currency} per person, $${convertCost(secondaryActivity.cost * persons).toFixed(2)} ${currency} total, Transport: ${transportToSecondary.time}, <a href="${secondaryActivity.url}" target="_blank">${secondaryActivity.url}</a>)</p>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="local-tips">Local Tips</h3>`;
        cityData.premiumExtras.localTips.forEach(tip => {
          itinerary += `<p>- ${tip}</p>`;
        });
        itinerary += `</div>`;
      }

      itinerary += `<p class="upgrade">Upgrade to Premium (code: TRAVEL2025) for your full trip plan! <span id="paypal-button-placeholder">[PayPal Button Placeholder]</span></p>`;

      // Recommendations
      const recommendations = cityData.recommendations[budget];
      itinerary += `<div class="recommendations ${isPremium ? '' : 'hidden'}">`;
      itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
      itinerary += `<p><strong>Activities:</strong></p>`;
      const filteredActivities = recommendations.activities.filter(activity => 
        activity.time === timeOfDay && activity.interest === interests
      );
      const activitiesToShow = filteredActivities.length > 0 ? filteredActivities : recommendations.activities.filter(activity => activity.interest === interests);
      activitiesToShow.forEach(activity => {
        const transportToRecActivity = isPremium ? calculateTransport(startLocation, activity.location, transport) : null;
        itinerary += `<p>- ${activity.name} ($${convertCost(activity.cost).toFixed(2)} ${currency} per person, $${convertCost(activity.cost * persons).toFixed(2)} ${currency} total, ${isPremium ? `Transport: ${transportToRecActivity.time}, ` : ''}<a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      });
      itinerary += `<p><strong>Dining:</strong></p>`;
      const filteredRestaurants = recommendations.restaurants.filter(restaurant => 
        restaurant.time === timeOfDay && restaurant.interest === interests
      );
      const restaurantsToShow = filteredRestaurants.length > 0 ? filteredRestaurants : recommendations.restaurants.filter(restaurant => restaurant.interest === interests);
      restaurantsToShow.forEach(restaurant => {
        const transportToRecRestaurant = isPremium ? calculateTransport(activity.location, restaurant.location, transport) : null;
        itinerary += `<p>- ${restaurant.name} ($${convertCost(restaurant.cost).toFixed(2)} ${currency} per person, $${convertCost(restaurant.cost * persons).toFixed(2)} ${currency} total, ${isPremium ? `Transport: ${transportToRecRestaurant.time}, ` : ''}<a href="${restaurant.url}" target="_blank">${restaurant.url}</a>, ${restaurant.type})</p>`;
      });
      itinerary += `</div>`;

      if (!isPremium) {
        itinerary += `<div class="recommendations">`;
        itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
        itinerary += `<p>Unlock personalized recommendations by subscribing to premium! Enter the code TRAVEL2025 to see more.</p>`;
        itinerary += `</div>`;
      }

      document.getElementById('output').innerHTML = itinerary;
    });

    // Function to rearrange itinerary to fit budget
    function rearrangeItinerary(country, city, startLocation, interests, transport, food, budget, currency, persons, timeOfDay, isPremium) {
      const cityData = travelData[country].cities[city];
      let itinerary = `<h2>Your ${city} 1-Day Free Itinerary (${persons} Person${persons > 1 ? 's' : ''}) - Rearranged to Fit Budget</h2>`;
      let totalCost = 0;

      const convertCost = (cost) => {
        const costInUSD = cost;
        const costInSelectedCurrency = costInUSD * exchangeRates[currency];
        return Math.round(costInSelectedCurrency * 100) / 100;
      };

      let budgetLimit;
      switch (budget) {
        case "low": budgetLimit = 50; break;
        case "medium": budgetLimit = 150; break;
        case "high": budgetLimit = Infinity; break;
      }
      const remainingBudget = budgetLimit * persons;

      const activities = cityData.activities[interests];
      let activity = findCheapestOption(activities, remainingBudget, persons, timeOfDay, interests, "activity");
      let activityCostPerPerson = convertCost(activity.cost);
      let activityCostTotal = convertCost(activity.cost * persons);
      let remainingAfterActivity = remainingBudget - activityCostTotal;

      const restaurants = cityData.restaurants[food];
      let restaurant = findCheapestOption(restaurants, remainingAfterActivity, persons, timeOfDay, interests, "restaurant");
      let restaurantCostPerPerson = convertCost(restaurant.cost);
      let restaurantCostTotal = convertCost(restaurant.cost * persons);

      const transportToActivity = isPremium ? calculateTransport(startLocation, activity.location, transport) : null;
      const transportToRestaurant = isPremium ? calculateTransport(activity.location, restaurant.location, transport) : null;
      let transportCostTotal = isPremium ? convertCost((transportToActivity.cost + transportToRestaurant.cost) * persons) : 0;

      totalCost = activityCostTotal + restaurantCostTotal + transportCostTotal;
      const totalCostPerPerson = totalCost / persons;

      itinerary += `<h3 class="day">Day 1 (Time of Day: ${timeOfDay.charAt(0).toUpperCase() + timeOfDay.slice(1)})</h3>`;
      if (!isPremium) {
        itinerary += `<p><strong>Location:</strong> Starting from ${startLocation}</p>`;
        itinerary += `<p><strong>Transport:</strong> Detailed transport options (time, cost, stops) available with premium subscription!</p>`;
      } else {
        itinerary += `<p><strong>Location:</strong> Starting from ${startLocation}</p>`;
        itinerary += `<p><strong>Transport to Activity (${activity.name}):</strong> ${transport} - $${convertCost(transportToActivity.cost).toFixed(2)} ${currency} per person ($${convertCost(transportToActivity.cost * persons).toFixed(2)} ${currency} total), Time: ${transportToActivity.time}, Stops: ${transportToActivity.stops}, Station: ${transportToActivity.station}, <a href="${cityData.transport[transport].url}" target="_blank">${cityData.transport[transport].url}</a></p>`;
        itinerary += `<p><strong>Transport to Meal (${restaurant.name}):</strong> ${transport} - $${convertCost(transportToRestaurant.cost).toFixed(2)} ${currency} per person ($${convertCost(transportToRestaurant.cost * persons).toFixed(2)} ${currency} total), Time: ${transportToRestaurant.time}, Stops: ${transportToRestaurant.stops}, Station: ${transportToRestaurant.station}, <a href="${cityData.transport[transport].url}" target="_blank">${cityData.transport[transport].url}</a></p>`;
      }
      itinerary += `<p><strong>Activity:</strong> ${activity.name} ($${activityCostPerPerson.toFixed(2)} ${currency} per person, $${activityCostTotal.toFixed(2)} ${currency} total, <a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      itinerary += `<p><strong>Meal:</strong> ${restaurant.name} ($${restaurantCostPerPerson.toFixed(2)} ${currency} per person, $${restaurantCostTotal.toFixed(2)} ${currency} total, <a href="${restaurant.url}" target="_blank">${restaurant.url}</a>)</p>`;
      itinerary += `<p><strong>Total Estimated Cost:</strong> $${totalCost.toFixed(2)} ${currency} ($${totalCostPerPerson.toFixed(2)} ${currency} per person)</p>`;

      if (isPremium) {
        itinerary += `<h3 class="premium-extras">Premium Extras</h3>`;
        itinerary += `<p><strong>Secondary Activity Suggestion:</strong></p>`;
        const secondaryActivities = cityData.premiumExtras.secondaryActivities.filter(activity => 
          activity.time === timeOfDay && activity.interest === interests
        );
        const secondaryActivity = secondaryActivities.length > 0 ? secondaryActivities[0] : cityData.premiumExtras.secondaryActivities.find(a => a.interest === interests) || cityData.premiumExtras.secondaryActivities[0];
        const transportToSecondary = calculateTransport(restaurant.location, secondaryActivity.location, transport);
        itinerary += `<p>- ${secondaryActivity.name} ($${convertCost(secondaryActivity.cost).toFixed(2)} ${currency} per person, $${convertCost(secondaryActivity.cost * persons).toFixed(2)} ${currency} total, Transport: ${transportToSecondary.time}, <a href="${secondaryActivity.url}" target="_blank">${secondaryActivity.url}</a>)</p>`;

        itinerary += `<div class="local-tip">`;
        itinerary += `<h3 class="local-tips">Local Tips</h3>`;
        cityData.premiumExtras.localTips.forEach(tip => {
          itinerary += `<p>- ${tip}</p>`;
        });
        itinerary += `</div>`;
      }

      itinerary += `<p class="upgrade">Upgrade to Premium (code: TRAVEL2025) for your full trip plan! <span id="paypal-button-placeholder">[PayPal Button Placeholder]</span></p>`;

      const recommendations = cityData.recommendations[budget];
      itinerary += `<div class="recommendations ${isPremium ? '' : 'hidden'}">`;
      itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
      itinerary += `<p><strong>Activities:</strong></p>`;
      const filteredActivities = recommendations.activities.filter(activity => 
        activity.time === timeOfDay && activity.interest === interests
      );
      const activitiesToShow = filteredActivities.length > 0 ? filteredActivities : recommendations.activities.filter(activity => activity.interest === interests);
      activitiesToShow.forEach(activity => {
        const transportToRecActivity = isPremium ? calculateTransport(startLocation, activity.location, transport) : null;
        itinerary += `<p>- ${activity.name} ($${convertCost(activity.cost).toFixed(2)} ${currency} per person, $${convertCost(activity.cost * persons).toFixed(2)} ${currency} total, ${isPremium ? `Transport: ${transportToRecActivity.time}, ` : ''}<a href="${activity.url}" target="_blank">${activity.url}</a>)</p>`;
      });
      itinerary += `<p><strong>Dining:</strong></p>`;
      const filteredRestaurants = recommendations.restaurants.filter(restaurant => 
        restaurant.time === timeOfDay && restaurant.interest === interests
      );
      const restaurantsToShow = filteredRestaurants.length > 0 ? filteredRestaurants : recommendations.restaurants.filter(restaurant => restaurant.interest === interests);
      restaurantsToShow.forEach(restaurant => {
        const transportToRecRestaurant = isPremium ? calculateTransport(activity.location, restaurant.location, transport) : null;
        itinerary += `<p>- ${restaurant.name} ($${convertCost(restaurant.cost).toFixed(2)} ${currency} per person, $${convertCost(restaurant.cost * persons).toFixed(2)} ${currency} total, ${isPremium ? `Transport: ${transportToRecRestaurant.time}, ` : ''}<a href="${restaurant.url}" target="_blank">${restaurant.url}</a>, ${restaurant.type})</p>`;
      });
      itinerary += `</div>`;

      if (!isPremium) {
        itinerary += `<div class="recommendations">`;
        itinerary += `<h3 class="recommendations">Popular Recommendations for Your Budget</h3>`;
        itinerary += `<p>Unlock personalized recommendations by subscribing to premium! Enter the code TRAVEL2025 to see more.</p>`;
        itinerary += `</div>`;
      }

      document.getElementById('output').innerHTML = itinerary;
    }
  </script>
</body>
</html>
